import os

def create_index(log_file, index_file):
    
    index = {}
    with open(log_file, 'r', encoding='utf-8') as f:
        while True:
            pos = f.tell()  
            line = f.readline()
            if not line:
                break
            date = line.split()[0]  
            if date not in index:
                index[date] = pos  

    with open(index_file, 'w') as idx:
        for date, offset in index.items():
            idx.write(f"{date} {offset}\n")

def fetch_logs_using_index(log_file, index_file, target_date):
  
    offset = None
    with open(index_file, 'r') as idx:
        for line in idx:
            date, pos = line.strip().split()
            if date == target_date:
                offset = int(pos)
                break

    if offset is None:
        print(f"No logs found for {target_date}")
        return

    with open(log_file, 'r', encoding='utf-8') as f:
        f.seek(offset) 
        with open(f"output/output_{target_date}.txt", 'w') as output:
            for line in f:
                if not line.startswith(target_date):
                    break  
                output.write(line)

